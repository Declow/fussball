CREATE TABLE Players (
  ID INTEGER PRIMARY KEY,
  Name VARCHAR(255)
);

CREATE TABLE EloRatings (
  ID INTEGER PRIMARY KEY,
  PlayerID INTEGER,
  Rating INTEGER,
  Date TIMESTAMP,
  FOREIGN KEY (PlayerID) REFERENCES Players(ID)
);

CREATE TABLE Teams (
  ID INTEGER PRIMARY KEY,
  team_player_1_id INTEGER,
  team_player_2_id INTEGER,
  FOREIGN KEY (team_player_1_id) REFERENCES Players(ID),
  FOREIGN KEY (team_player_2_id) REFERENCES Players(ID)
);

CREATE TABLE Matches (
  ID INTEGER PRIMARY KEY,
  Date TIMESTAMP,
  Team1ID INTEGER,
  Team2ID INTEGER,
  Team1Score INTEGER,
  Team2Score INTEGER,
  FOREIGN KEY (Team1ID) REFERENCES Teams(ID),
  FOREIGN KEY (Team2ID) REFERENCES Teams(ID)
);

CREATE TABLE MatchPlayers (
  ID INTEGER PRIMARY KEY,
  MatchID INTEGER,
  PlayerID INTEGER,
  FOREIGN KEY (MatchID) REFERENCES Matches(ID),
  FOREIGN KEY (PlayerID) REFERENCES Players(ID)
);

CREATE TABLE eloratings_teams (
    id SERIAL PRIMARY KEY,
	teamid INTEGER,
    FOREIGN KEY (teamid) REFERENCES Teams(ID),
    rating INTEGER,
    date TIMESTAMP
);


CREATE SEQUENCE teams_id_seq START 1;
CREATE SEQUENCE players_id_seq START 1;
CREATE SEQUENCE matches_id_seq START 1;
CREATE SEQUENCE matchplayers_id_seq START 1;
CREATE SEQUENCE eloratings_id_seq START 1;
CREATE SEQUENCE eloratings_teams_id_seq START 1;

ALTER TABLE matchplayers
ALTER COLUMN id SET DEFAULT nextval('matcheplayers_id_seq');
ALTER TABLE matches
ALTER COLUMN id SET DEFAULT nextval('matches_id_seq');
ALTER TABLE eloratings
ALTER COLUMN id SET DEFAULT nextval('eloratings_id_seq');